{% from "components/big-number.html" import big_number %}
{% from "components/message-count-label.html" import message_count_label %}
{% from "components/table.html" import list_table, field, hidden_field_heading, row_heading, text_field, spark_bar_field, spark_bar %}
{% from "components/report-nav.html" import report_nav %}

{% extends "withnav_template.html" %}

{% block service_page_title %}
  Reports
{% endblock %}

{% block maincolumn_content %}

    {% include 'views/reports/_heading.html' %}

    {{ report_nav(selected, current_service=current_service) }}

    <div class="grid-row">
      <div class="column-half">
        {% include 'views/reports/_current-financial-year.html' %}
      </div>
      <div class="column-half">
        {% include 'views/reports/_download.html' %}
      </div>
    </div>
    <div class='dashboard-table-1-3 dashboard-table'>
      {% call(item, row_number) list_table(
        weeks,
        caption='foo',
        caption_visible=False,
        empty_message='',
        field_headings=[
          hidden_field_heading('Week'),
          hidden_field_heading('Week'),
          hidden_field_heading('Numbers'),
        ],
        field_headings_visible=False
      ) %}
        {% call row_heading() %}
          <span class="file-list-filename" style="position: relative; top: 10px; font-weight: normal;">
            {{ item[0] }} to<br>
            {{ item[1] }}
          </span>
        {% endcall %}
        {% call field(align='left') %}
          <p class="tabular-numbers" style="position: relative; top: 5px; left: 30px;">
            {% if numbers[row_number] %}
              Emails<br>
              <br>
              <br>
            {% endif %}
            {% if numbers[row_number + 1] %}
              Text messages<br>
              <br>
              <br>
            {% endif %}
            {% if numbers[-row_number] %}
              Letters
            {% endif %}
          </p>
        {% endcall %}
        {% call field(align='left') %}
          {% if numbers[row_number] %}
            {{ spark_bar(numbers[row_number * 3], highest_number, failure_rate=failures[row_number * 3]) }}
          {% endif %}
          {% if numbers[row_number + 1] %}
            {{ spark_bar(numbers[(row_number * 3) + 1], highest_number, failure_rate=failures[(row_number * 3) + 1]) }}
          {% endif %}
          {% if numbers[-row_number] %}
            {{ spark_bar(numbers[(row_number * 3) - 1], highest_number, failure_rate=0) }}
          {% endif %}
        {% endcall %}
      {% endcall %}
    </div>

    {% from "components/previous-next-navigation.html" import previous_next_navigation %}
    {{ previous_next_navigation({
      'url': '#',
      'title': '2016 to 2017',
      'label': 'financial year'
    }, {
      'url': '#',
      'title': '2018 to 2019',
      'label': 'financial year'
    }) }}

{% endblock %}
